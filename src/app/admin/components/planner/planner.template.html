<div class="col-md-2 col-sm-4 col-xs-4 xpd-admin-col">

    <div class="xpd-admin-col-header">
        Current: {{operationData.suboperationContext.currentSuboperation.type}}
    </div>


    <div class="xpd-admin-col-content">

        <ul class="nav xpd-green-styled-box stacked" role="tablist" ng-repeat="state in operationData.suboperationContext.currentSuboperation.jointIntervals">

            <br/>

            <li role="presentation" class="planner-list-item disabled" ng-class="{'active': state.state == dados.selectedState}">
                <a>{{ state.label }}</a>
                <div class="button-bellow-label" uib-popover="Joint Interval" popover-placement="top-right" popover-trigger="'mouseenter'">{{ state.initialJoint }} - {{ state.finalJoint }}</div>
            </li>

            <li class=" planner-sum-trip-conn">
                1 TRIP + 1 CONN = {{ pController.sumTripConnduration(dados.settings[state.state]) | date: 'HH:mm:ss': '+0000' }}
                
            </li>


            <li role="presentation" class="planner-list-item" ng-class="{'active': dados.selectedEventType == 'CONN' && state.state == dados.selectedState}"
                ng-click="pController.actionSelectActivityToPlan(state.state, 'CONN')" ng-init="pController.selectActivityOnInit($index, state.state, 'CONN')">
                <a>Connection</a>
            </li>

            <li role="presentation" class="planner-list-item" ng-class="{'active': dados.selectedEventType == 'TRIP' && state.state == dados.selectedState}"
                ng-click="pController.actionSelectActivityToPlan(state.state, 'TRIP')">
                <a>Trip</a>
            </li>


        </ul>

    </div>
</div>

<div class="col-md-6 col-sm-8 col-xs-8 xpd-admin-col has-footer" ng-if="( dados.settings[dados.selectedState][dados.selectedEventType].eventType != 'CONN' && dados.settings[dados.selectedState][dados.selectedEventType].eventType != 'TRIP' )">
    <div class="xpd-chart-placeholder">
        <span class="xpd-chart-placeholder-text" ng-if="dados.settings[dados.selectedState][dados.selectedEventType].eventType == null">Select a State/Event</span>
        <span class="xpd-chart-placeholder-text" ng-if="dados.settings[dados.selectedState][dados.selectedEventType].eventType != null">Operation not supported due to missing parameters or state not subjected to planning</span>
    </div>
</div>

<div class="col-md-6 col-sm-8 col-xs-8 xpd-admin-col has-footer" ng-if="dados.settings[dados.selectedState][dados.selectedEventType].eventType == 'CONN'">
    <xpd-connection-planner 
        label="{{ dados.settings[dados.selectedState][dados.selectedEventType].label }} " 
        target-speed="dados.settings[dados.selectedState][dados.selectedEventType].targetSpeed"
        target-time="dados.settings[dados.selectedState][dados.selectedEventType].targetTime" 
        optimum-speed="dados.settings[dados.selectedState][dados.selectedEventType].optimumSpeed"
        time-slices="dados.timeSlices" 
        action-button-apply="pController.actionButtonApplyConn()" />
</div>

<div class="col-md-6 col-sm-8 col-xs-8 xpd-admin-col has-footer" ng-if="dados.settings[dados.selectedState][dados.selectedEventType].eventType == 'TRIP'">
    <xpd-trip-planner 
        label="{{ dados.settings[dados.selectedState][dados.selectedEventType].label }}" 
        target-speed="dados.settings[dados.selectedState][dados.selectedEventType].targetSpeed"
        target-time="dados.settings[dados.selectedState][dados.selectedEventType].targetTime" 
        optimum-speed="dados.settings[dados.selectedState][dados.selectedEventType].optimumSpeed"
        displacement="dados.settings[dados.selectedState][dados.selectedEventType].displacement" 
        vcruising="dados.settings[dados.selectedState][dados.selectedEventType].vcruising"
        optimum-safety-speed-limit="dados.settings[dados.selectedState][dados.selectedEventType].optimumSafetySpeedLimit" 
        target-safety-speed-limit="dados.settings[dados.selectedState][dados.selectedEventType].targetSafetySpeedLimit"
        optimum-acceleration-time-limit="dados.settings[dados.selectedState][dados.selectedEventType].optimumAccelerationTimeLimit"
        target-acceleration-time-limit="dados.settings[dados.selectedState][dados.selectedEventType].targetAccelerationTimeLimit"
        optimum-deceleration-time-limit="dados.settings[dados.selectedState][dados.selectedEventType].optimumDecelerationTimeLimit"
        target-deceleration-time-limit="dados.settings[dados.selectedState][dados.selectedEventType].targetDecelerationTimeLimit"
        stick-up="operationData.operationContext.currentOperation.stickUp" 
        upper-stop="operationData.operationContext.currentOperation.upperStop"
        slips-time="operationData.operationContext.currentOperation.inSlips" 
        in-slips-default="operationData.operationContext.currentOperation.inSlipsDefault"
        current-operation="operationData.operationContext.currentOperation" 
        action-button-apply="pController.actionButtonApplyTrip()"
    />
</div>

<div class="col-md-4 col-sm-12 col-xs-12 xpd-admin-col">

    <div class="xpd-admin-col-content">

        <div class="planner-forecast-row">

            <div class="xpd-chart-container  has-footer">
                <div class="xpd-chart-container-header">
                    Operation Progress
                </div>
                <div class="xpd-chart-container-content" ng-if="dados.settings[dados.selectedState][dados.selectedEventType].stateName && operationData.operationProgressContext.operationProgressData[dados.settings[dados.selectedState][dados.selectedEventType].stateName]">
                    <div class="xpd-chart" xpd-operation-progress-chart progress-data="operationData.operationProgressContext.operationProgressData[dados.settings[dados.selectedState][dados.selectedEventType].stateName]"
                        progress-data-delay="operationData.operationProgressContext.progressDataDelay"></div>


                </div>
                <div class="xpd-chart-container-content col-md-12" ng-if="!dados.settings[dados.selectedState][dados.selectedEventType].stateName || !operationData.operationProgressContext.operationProgressData[dados.settings[dados.selectedState][dados.selectedEventType].stateName]">
                    <div class="xpd-chart-placeholder">
                        <span class="xpd-chart-placeholder-text">
                            No Operation Progress
                        </span>
                    </div>
                </div>
                <div class="xpd-chart-container-footer operation-progress-delay-container">
                    <div class="operation-progress-delay">
                        <div class="operation-progress-delay-title">
                            Progress Delay
                        </div>
                        <div class="operation-progress-delay-info">
                            <table class="table">
                                <tr>
                                    <td ng-repeat="delayLog in operationData.operationProgressContext.progressDataDelay">
                                        {{delayLog.name}}:
                                        <span>{{delayLog.time | secondsToHourMinutes}}</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="planner-forecast-row">

            <div class="planner-forecast-grid">

                <div class="planner-forecast-cell planner-forecast-cell-full">
                    <div 
                        class="xpd-chart" 
                        is-tripin = "operationData.suboperationContext.currentSuboperation.tripin"
                        xpd-forecast-line settings='dados.settings' 
                        state="{{dados.selectedState}}" 
                        type="{{dados.selectedEventType}}"
                        v-target-line="operationData.forecastContext.vTargetEstimative" 
                        actual-line="operationData.forecastContext.actualLine"></div>
                </div>

                <div class="planner-forecast-cell planner-forecast-cell-full">
                    <div 
                        class="xpd-chart" 
                        is-tripin = "operationData.suboperationContext.currentSuboperation.tripin"
                        xpd-forecast-line settings='dados.settings' 
                        state="{{dados.selectedState}}" 
                        type="{{ 'BOTH' }}" 
                        v-target-line="operationData.forecastContext.vTargetEstimative"
                        actual-line="operationData.forecastContext.actualLine"></div>
                </div>

            </div>

        </div>
    </div>

</div>